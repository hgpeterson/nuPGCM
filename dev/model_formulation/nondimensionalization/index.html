<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Nondimensionalization · νPGCM</title><meta name="title" content="Nondimensionalization · νPGCM"/><meta property="og:title" content="Nondimensionalization · νPGCM"/><meta property="twitter:title" content="Nondimensionalization · νPGCM"/><meta name="description" content="Documentation for νPGCM."/><meta property="og:description" content="Documentation for νPGCM."/><meta property="twitter:description" content="Documentation for νPGCM."/><script data-outdated-warner src="../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../search_index.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script><link href="../../assets/citations.css" rel="stylesheet" type="text/css"/></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../../">νPGCM</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../../">Overview</a></li><li><input class="collapse-toggle" id="menuitem-2" type="checkbox" checked/><label class="tocitem" for="menuitem-2"><span class="docs-label">Model Formulation</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../pg_equations/">The PG Equations</a></li><li class="is-active"><a class="tocitem" href>Nondimensionalization</a><ul class="internal"><li><a class="tocitem" href="#Boundary-conditions"><span>Boundary conditions</span></a></li><li><a class="tocitem" href="#Scales-and-parameter-values"><span>Scales and parameter values</span></a></li></ul></li><li><a class="tocitem" href="../numerical_approach/">Numerical Approach</a></li></ul></li><li><a class="tocitem" href="../../references/">References</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Model Formulation</a></li><li class="is-active"><a href>Nondimensionalization</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Nondimensionalization</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/hgpeterson/nuPGCM" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/hgpeterson/nuPGCM/blob/main/docs/src/model_formulation/nondimensionalization.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Nondimensionalization"><a class="docs-heading-anchor" href="#Nondimensionalization">Nondimensionalization</a><a id="Nondimensionalization-1"></a><a class="docs-heading-anchor-permalink" href="#Nondimensionalization" title="Permalink"></a></h1><p>To isolate role of the aspect ratio, the <span>$\nu$</span>PGCM ultimately solves the nondimensional PG equations, which we will derive here. We scale all spatial coordinates by the natural length scale of the domain <span>$L$</span> (e.g., the width of the basin) and all velocities by the same scale:</p><p class="math-container">\[x = L \nd{x}, \quad y = L \nd{y}, \quad z = L \nd{z} \quad \mathrm{and} \quad u = U \nd{u}, \quad v = U \nd{v}, \quad w = U \nd{w}.\]</p><p>Although the code supports arbitrary initial conditions, we typically initialize all simulations with flat isopycnals aligned with gravity and constant stratification <span>$N^2$</span> such that <span>$\partial_z b = N^2$</span> at <span>$t = 0$</span>. A natural scaling for buoyancy, therefore, would be <span>$b \sim N^2 H_0$</span> for some depth scale of the ocean <span>$H_0$</span>. Unlike in quasi-geostrophic theory, however, the PG equations do not explicitly impose a background stratification so that, in general, a representative scale for <span>$N^2$</span> in the abyssal ocean will depend on the context of the problem. We additionally define characteristic scales for the Coriolis parameter and mixing coefficients:</p><p class="math-container">\[f \sim f_0, \quad \nu \sim \nu_0, \quad \kappa \sim \kappa_0.\]</p><p>Finally, we assume that the pressure gradient term in the momentum equation scales with the Coriolis term, that the buoyancy also scales with the pressure scale divided by <span>$H_0$</span> from hydrostatic balance, and that time scales advectively:</p><p class="math-container">\[p \sim f U L, \quad b \sim \frac{f U L}{H_0} = N^2 H_0, \quad t \sim \frac{L}{U}.\]</p><p>Applying these scales yields the following nondimensional PG equations:</p><p class="math-container">\[\begin{aligned}
    \nd{f} \vec{z} \times \nd{\vec{u}} &amp;= -\nd{\nabla} \nd{p} + \alpha^{-1} \nd{b} \vec{z} + \alpha^2 \varepsilon^2 \nd{\nabla} \cdot \left( 2 \nd{\nu} \nd{\sigma}(\nd{\vec{u}}) \right), \hphantom{\frac12}\\
    \nd{\nabla} \cdot \nd{\vec{u}} &amp;= 0, \hphantom{\frac12}\\
    \mu\varrho \left( \pder{\nd{b}}{\nd{t}} + \nd{\vec{u}} \cdot \nd{\nabla}\nd{b} \right) &amp;= \alpha^2 \varepsilon^2 \nd{\nabla} \cdot \left( \nd{\kappa} \nd{\nabla} \nd{b} \right),
\end{aligned}\]</p><p>where <span>$\alpha = H_0 / L$</span> is the aspect ratio, <span>$\varepsilon^2 = \nu_0 / f_0 H_0^2$</span> is the Ekman number, <span>$\varrho = N^2 H_0^2 / f_0^2 L^2$</span> is the Burger number, and <span>$\mu = \nu_0/\kappa_0$</span> is the turbulent Prandtl number.</p><p><em>Figure here?</em></p><p>With all three spatial coordinates scaled by <span>$L$</span>, the effect of the aspect ratio <span>$\alpha$</span> on the dynamics is made explicit and the domain <span>$\mathcal{D}$</span> itself must have an aspect ratio of <span>$\alpha$</span>, i.e., <span>$-\alpha \le z \le 0$</span> (figure?). This scaling guarantees that the viscous friction term in the momentum equation is spatially isotropic, a desirable property for computing numerical solutions. More importantly, for <span>$\alpha &gt; 0$</span> hydrostatic balance is not exactly required, as can be seen by dotting the momentum equation with <span>$\vec{z}$</span>:</p><p class="math-container">\[\pder{\nd{p}}{\nd{z}} = \alpha^{-1} \nd{b} + \alpha^2 \varepsilon^2 \nd{\nabla} \cdot \left( 2 \nd{\nu} \nd{\sigma}(\nd{\vec{u}}) \right) \cdot \vec{z}.\]</p><p>For the ocean, typical order-of-magnitude length scales are <span>$H \approx 10^3$</span> m and <span>$L \approx 10^6$</span> m, implying <span>$\alpha \approx 10^{-3}$</span>. Hence, the small aspect ratio assumption is often made, eliminating the diffusion term on the RHS. While standard finite element techniques may be used to solve the Stokes problem with rotation, they become brittle under this approximation (e.g., [<a href="../../references/#guillen-gonzalez_analysis_2015">1</a>]). To leverage established methods, we will therefore keep <span>$\alpha$</span> larger than zero but small enough to capture the qualitative dynamics of the ocean. A similar approach was taken by [<a href="../../references/#salmon_simplified_1986">2</a>] for a PG model with Rayleigh drag.</p><h2 id="Boundary-conditions"><a class="docs-heading-anchor" href="#Boundary-conditions">Boundary conditions</a><a id="Boundary-conditions-1"></a><a class="docs-heading-anchor-permalink" href="#Boundary-conditions" title="Permalink"></a></h2><p>Now let&#39;s work out how the boundary conditions must change under this particular nondimensionalization. Of course, the no-slip and no-normal-flow conditions at the bottom still imply <span>$\nd{\vec{u}} = 0$</span> at <span>$\nd{z} = -\nd{H}$</span>. Since the buoyancy flux and wind stress boundary conditions involve vertical derivatives, though, we must take some care to ensure that they scale properly in the limit as <span>$\alpha \to 0$</span>. </p><h3 id="Surface-wind-stress"><a class="docs-heading-anchor" href="#Surface-wind-stress">Surface wind stress</a><a id="Surface-wind-stress-1"></a><a class="docs-heading-anchor-permalink" href="#Surface-wind-stress" title="Permalink"></a></h3><p>To illustrate this point, it helps to think about the net meridional transport <span>$\psi$</span>, defined such that</p><p class="math-container">\[-\pder{\psi}{z} = v \quad \text{and} \quad \pder{\psi}{x} = w.\]</p><p>Recall that the velocity scale <span>$U = N^2 H_0^2 / f_0 L$</span>. As with buoyancy, we want <span>$\psi$</span> to scale like <span>$U H_0$</span> (not <span>$U L$</span>), so we have</p><p class="math-container">\[-\alpha \pder{\nd{\psi}}{\nd{z}} = \nd{v}.\]</p><p>As <span>$\alpha \to 0$</span>, the vertical derivative terms in the <span>$x$</span>-momentum equation should dominate such that</p><p class="math-container">\[-\nd{f} \nd{v} = -\pder{\nd{p}}{\nd{x}} + \alpha^2 \varepsilon^2 \pder{}{\nd{z}} \left( \nd{\nu} \pder{\nd{u}}{\nd{z}} \right).\]</p><p>Integrating in <span>$z$</span>, this gives</p><p class="math-container">\[-\prettyint{\nd{z}}{0}{\nd{f}\nd{v}}{\nd{z}&#39;} = -\alpha \nd{f} \nd{\psi} \sim \alpha^2 \varepsilon^2 \nd{\nu} \pder{\nd{u}}{\nd{z}} \Big|_{\nd{z} = 0},\]</p><p>neglecting the pressure gradient term and shear in the interior. Here&#39;s where the limit comes in: as <span>$\alpha \to 0$</span>, we want this interior transport to be equal to the wind-driven circulation, i.e., <span>$\nd{\psi} \sim -\nd{\tau}^x/\nd{f}$</span>. For this to be true, we must have</p><p class="math-container">\[\alpha^2 \varepsilon^2 \nd{\nu} \pder{\nd{u}}{\nd{z}} = \alpha \nd{\tau}^x \quad \text{at} \quad \nd{z} = 0,\]</p><p>or, more generally,</p><p class="math-container">\[\boxed{\alpha^2 \varepsilon^2 \nd{\nu} \pder{\nd{\vec{u}}_\perp}{\nd{z}} = \alpha \nd{\vec{\tau}} \quad \text{at} \quad \nd{z} = 0.}\]</p><h3 id="Surface-buoyancy-flux"><a class="docs-heading-anchor" href="#Surface-buoyancy-flux">Surface buoyancy flux</a><a id="Surface-buoyancy-flux-1"></a><a class="docs-heading-anchor-permalink" href="#Surface-buoyancy-flux" title="Permalink"></a></h3><p>What about the surface buoyancy flux condition? Here we want to ensure that the column-average buoyancy tendency remains fixed as <span>$\alpha \to 0$</span>. Integrating the buoyancy equation with advection neglected and diffusion only in the vertical, we have</p><p class="math-container">\[\frac{1}{\alpha} \prettyint{-\alpha}{0}{\pder{\nd{b}}{\nd{t}}}{\nd{z}} = \frac{\alpha \varepsilon^2}{\mu \varrho} \nd{\kappa}\pder{\nd{b}}{\nd{z}} \Big|_{\nd{z} = 0} \equiv \nd{\mathcal{F}},\]</p><p>assuming <span>$\partial_{\nd{z}} \nd{b} = 0$</span> at the bottom. We therefore define our nondimensional surface buoyancy flux boundary condition as </p><p class="math-container">\[\boxed{\frac{\alpha^2 \varepsilon^2}{\mu \varrho} \nd{\kappa}\pder{\nd{b}}{\nd{z}} = \alpha \nd{\mathcal{F}} \quad \text{at} \quad \nd{z} = 0.}\]</p><h2 id="Scales-and-parameter-values"><a class="docs-heading-anchor" href="#Scales-and-parameter-values">Scales and parameter values</a><a id="Scales-and-parameter-values-1"></a><a class="docs-heading-anchor-permalink" href="#Scales-and-parameter-values" title="Permalink"></a></h2><p>The parameters <span>$\varepsilon$</span>, <span>$\mu$</span>, and <span>$\varrho$</span> are free to be chosen to match the physical context. The Coriolis parameter for Earth is about <span>$f_0 \approx 10^{-4}$</span> s<span>$^{-1}$</span> and the stratification in the deep ocean is around <span>$N \approx 10^{-3}$</span> s<span>$^{-1}$</span>, yielding a Burger number of <span>$\varrho \approx 10^{-4}$</span>. Over rough topography, one might expect strong turbulence associated with a turbulent diffusivity on the order of <span>$\kappa_0 \approx 10^{-3}$</span> m<span>$^2$</span> s<span>$^{-1}$</span> (e.g., [<a href="../../references/#waterhouse_global_2014">3</a>]). The magnitude of the turbulent viscosity depends on whether or not a parameterization of eddies is considered. Without eddies, it is reasonable to assume that, for weakly stratified abyssal waters, small-scale mixing of buoyancy would occur on similar scales to the mixing of momentum, implying that <span>$\nu_0 \sim \kappa_0$</span>, or <span>$\mu \sim 1$</span> (e.g., [<a href="../../references/#caulfield_layering_2021">4</a>]). An Eliassen–Palm flux equivalent to an eddy diffusivity of <span>$K \approx 10^3$</span> m<span>$^2$</span> s<span>$^{-1}$</span> [<a href="../../references/#gent_isopycnal_1990">5</a>], however, would require an enhanced viscosity of <span>$\nu_0 \approx 10$</span> m<span>$^2$</span> s<span>$^{-1}$</span>, or <span>$\mu \approx 10^4$</span>. In the first case, where <span>$\nu_0 \approx 10^{-3}$</span> m<span>$^2$</span> s<span>$^{-1}$</span>, the Ekman number <span>$\varepsilon$</span> is on the order of <span>$10^{-3}$</span>. In the eddy-parameterizing case of <span>$\nu_0 \approx 10$</span> m<span>$^2$</span> s<span>$^{-1}$</span>, on the other hand, it is enhanced to <span>$\varepsilon \approx 10^{-1}$</span>. Given that the nondimensional bottom Ekman layer thickness <span>$\delta/L = \sqrt{2 \nu_0 / (f_0 L^2)} = \sqrt{2} \, \alpha \varepsilon$</span>, these differences are crucial in setting the minimum resolution required for the simulation.</p><p>For the surface wind stress boundary condition, we have</p><p class="math-container">\[\frac{\nu_0 U}{L} \nd{\nu} \pder{\nd{u}}{\nd{z}} = \frac{\tau_0}{\rho_0} \nd{\tau}.\]</p><p>To be consistent with the boundary condition derived above, this implies that the wind stress scale should be</p><p class="math-container">\[\tau_0 = \frac{\rho_0}{\alpha \varepsilon^2} \frac{\nu_0 N^2 H_0^2}{f_0 L^2} = \frac{\rho_0 N^2 H_0^3}{L} \approx 1 \text{ N m}^{-2},\]</p><p>using the scales chosen above and a reference density of <span>$\rho_0 = 10^3$</span> kg m<span>$^{-3}$</span>. This means that a dimensional wind stress of 0.1 N m<span>$^{-2}$</span> would translate to a nondimensional value of <span>$\nd{\tau} = 0.1$</span>.</p><p>For the surface buoyancy flux, we have</p><p class="math-container">\[\frac{\kappa_0 N^2 H_0}{L} \nd{\kappa} \pder{\nd{b}}{\nd{z}} = \mathcal{F}_0 \nd{\mathcal{F}},\]</p><p>which, to be consistent with the for derived above, implies</p><p class="math-container">\[\mathcal{F}_0 = \frac{\mu \varrho}{\alpha \varepsilon^2} \frac{\kappa_0 N^2 H_0}{L} = \frac{N^4 H_0^4}{f_0 L^2} \approx 10^{-8} \text{ m}^2 \text{ s}^{-3},\]</p><p>using the scales above. This means that a typical surface buoyancy flux of about 0.01 mm<span>$^2$</span> s<span>$^{-3}$</span> would translate to a nondimensional value of <span>$\nd{\mathcal{F}} = 1$</span>.</p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../pg_equations/">« The PG Equations</a><a class="docs-footer-nextpage" href="../numerical_approach/">Numerical Approach »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.16.1 on <span class="colophon-date" title="Thursday 4 December 2025 22:51">Thursday 4 December 2025</span>. Using Julia version 1.10.2.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
